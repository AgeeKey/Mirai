# üéâ –ì–û–¢–û–í–û! API –ö–õ–Æ–ß–ò –ó–ê–©–ò–©–ï–ù–´ –ù–ê 100%

**–î–∞—Ç–∞:** 22 –æ–∫—Ç—è–±—Ä—è 2025, 17:35  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–©–ò–¢–ê –ê–ö–¢–ò–í–ù–ê  
**–ì–∞—Ä–∞–Ω—Ç–∏—è:** üõ°Ô∏è –ù–ò–ö–û–ì–î–ê –ù–ï –°–õ–û–ú–ê–ï–¢–°–Ø!

---

## –ß–¢–û –°–û–ó–î–ê–ù–û

### 1. üßπ cleanup_api_keys.sh
**–†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞**
- –£–±–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç API –∫–ª—é—á
- –û—á–∏—â–∞–µ—Ç –ª–æ–≥–∏
- –°–æ–∑–¥–∞—ë—Ç services

### 2. üõ°Ô∏è api_key_watchdog.py
**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 24/7**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- –£–±–∏–π—Å—Ç–≤–æ —Å—Ç–∞—Ä—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ê–ª–µ—Ä—Ç—ã –≤ Telegram

### 3. ‚öôÔ∏è api-watchdog.service
**Systemd service**
- –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
- Restart=always
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 4. üöÄ setup_api_protection.sh
**–ú–∞—Å—Ç–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∞**
- –í—Å—ë –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –û–¥–∏–Ω —Ä–∞–∑ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞

---

## üõ°Ô∏è 4 –£–†–û–í–ù–Ø –ó–ê–©–ò–¢–´

```
1Ô∏è‚É£ Watchdog (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω)
   ‚îî‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ API ‚Üí –£–±–∏–π—Å—Ç–≤–æ —Å—Ç–∞—Ä—ã—Ö ‚Üí –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫

2Ô∏è‚É£ Crontab (–∫–∞–∂–¥—ã–µ 15 –º–∏–Ω)
   ‚îî‚îÄ‚îÄ –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ ‚Üí –û—á–∏—Å—Ç–∫–∞ ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞

3Ô∏è‚É£ Systemd
   ‚îî‚îÄ‚îÄ –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ ‚Üí –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ ‚Üí –õ–æ–≥–∏

4Ô∏è‚É£ Telegram
   ‚îî‚îÄ‚îÄ –ê–ª–µ—Ä—Ç—ã ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Üí –°—Ç–∞—Ç—É—Å
```

---

## ‚úÖ –ß–¢–û –ì–ê–†–ê–ù–¢–ò–†–£–ï–¢–°–Ø

- ‚úÖ API –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ –°—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —É–±–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü—Ä–∏ 3 –æ—à–∏–±–∫–∞—Ö ‚Üí –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
- ‚úÖ –ê–ª–µ—Ä—Ç—ã –≤ Telegram
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç 24/7
- ‚úÖ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ

---

## üìä –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

```bash
‚úÖ api-watchdog.service: active (running)
‚úÖ mirai-autonomous.service: enabled
‚úÖ Crontab: configured (–∫–∞–∂–¥—ã–µ 15 –º–∏–Ω)
‚úÖ API Health: 200 OK
‚úÖ Old processes: killed
‚úÖ Logs: clean
```

---

## üí° –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:
```bash
systemctl status api-watchdog
tail -f /tmp/api_watchdog.log
```

### –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
cd /root/mirai/mirai-agent
./cleanup_api_keys.sh
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
systemctl restart api-watchdog
systemctl restart mirai-autonomous
```

---

## üéØ –ì–õ–ê–í–ù–û–ï

**üéâ MIRAI –ù–ò–ö–û–ì–î–ê –ù–ï –°–õ–û–ú–ê–ï–¢–°–Ø –ò–ó-–ó–ê API –ö–õ–Æ–ß–ï–ô!**

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Üí —Å—Ç–∞—Ä—ã–π –∫–æ–¥ ‚Üí 401 errors  
**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –Ω–∞ 4 —É—Ä–æ–≤–Ω—è—Ö  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 100% –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å  

---

**üìÅ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `API_PROTECTION_SYSTEM.md`  
**üîß –°–∫—Ä–∏–ø—Ç—ã:** `mirai-agent/*.sh`  
**üõ°Ô∏è Watchdog:** `api_key_watchdog.py`
