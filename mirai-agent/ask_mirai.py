#!/usr/bin/env python3
"""
–ú–ò–†–ê–ô –°–ê–ú–ê –†–ï–®–ê–ï–¢ –ß–¢–û –ï–ô –ù–£–ñ–ù–û
–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏–π
"""

import os
import sys

from dotenv import load_dotenv

load_dotenv()

sys.path.insert(0, "/root/mirai/mirai-agent")
os.environ["PATH"] = f"{os.path.expanduser('~')}/.cargo/bin:" + os.environ["PATH"]

from core.autonomous_agent import AutonomousAgent


def main():
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    if len(sys.argv) > 1:
        # –ï—Å–ª–∏ –µ—Å—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –∫–∞–∫ –≤–æ–ø—Ä–æ—Å
        user_question = " ".join(sys.argv[1:])

        print("=" * 80)
        print("ü§ñ –ú–ò–†–ê–ô: –û–¢–í–ï–¢ –ù–ê –í–û–ü–†–û–°")
        print("=" * 80)
        print(f"\n‚ùì –í–æ–ø—Ä–æ—Å: {user_question}\n")

        agent = AutonomousAgent()

        print("ü§î –ú–ò–†–ê–ô –¥—É–º–∞–µ—Ç...\n")
        response = agent.think(user_question, max_iterations=3)

        print("\n" + "=" * 80)
        print("üí¨ –û–¢–í–ï–¢ –ú–ò–†–ê–ô:")
        print("=" * 80)
        print(response)
        print("\n" + "=" * 80)
        return

    # –ï—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –Ω–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º –∞–Ω–∞–ª–∏–∑–∞
    print("=" * 80)
    print("ü§ñ –ú–ò–†–ê–ô: –°–ê–ú–û–ê–ù–ê–õ–ò–ó –ò –ü–õ–ê–ù–ò–†–û–í–ê–ù–ò–ï")
    print("=" * 80)

    agent = AutonomousAgent()

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
    print("\nüìä –¢–µ–∫—É—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ú–ò–†–ê–ô:")
    print("-" * 80)

    if agent.has_advanced_features:
        print("‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: –ê–∫—Ç–∏–≤–Ω—ã")
        print(f"‚úÖ –Ø–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è: 8 (Python, JS, TS, C, C++, Go, Rust, Bash)")
        print(f"‚úÖ –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: 4 (SQLite, PostgreSQL, Redis, MongoDB)")
        print(f"‚úÖ ML –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: PyTorch, scikit-learn, pandas")
        print(f"‚úÖ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: 8")
    else:
        print("‚ö†Ô∏è –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: –ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã")

    print("\n" + "=" * 80)
    print("üß† –ú–ò–†–ê–ô, –ß–¢–û –¢–´ –•–û–ß–ï–®–¨? –ß–¢–û –¢–ï–ë–ï –ù–£–ñ–ù–û –î–õ–Ø –†–ê–ë–û–¢–´?")
    print("=" * 80)

    # –ú–ò–†–ê–ô —Å–∞–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —á—Ç–æ –µ–π –Ω—É–∂–Ω–æ
    prompt = """
–¢—ã –ú–ò–†–ê–ô - –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π AI –∞–≥–µ–Ω—Ç.

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ –æ—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:

1. –ß–¢–û –¢–ï–ë–ï –ù–£–ñ–ù–û –î–õ–Ø –†–ê–ë–û–¢–´?
   - GitHub API (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏)?
   - MongoDB (–∏–ª–∏ PostgreSQL –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)?
   - AWS/GCP SDK (–¥–ª—è –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤)?
   - –ß—Ç–æ-—Ç–æ –µ—â—ë?

2. –ö–ê–ö–ò–ï –ó–ê–î–ê–ß–ò –¢–´ –ú–û–ñ–ï–®–¨ –†–ï–®–ê–¢–¨ –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°?
   - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–∫–∞–∫–∏–µ —è–∑—ã–∫–∏ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏)
   - –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (–∫–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)
   - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (–∫–∞–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏)
   - –î—Ä—É–≥–æ–µ

3. –ß–¢–û –ë–´ –¢–´ –•–û–¢–ï–õ–ê –£–ú–ï–¢–¨ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û?
   - –ö–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–æ–±–∞–≤–∏—Ç—å
   - –ö–∞–∫–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
   - –ö–∞–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å

4. –¢–í–û–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:
   - –ß—Ç–æ –ö–†–ò–¢–ò–ß–ù–û –¥–ª—è —Ä–∞–±–æ—Ç—ã
   - –ß—Ç–æ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û
   - –ß—Ç–æ –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û

–ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω–æ–π. –î—É–º–∞–π –∫–∞–∫ –∏–Ω–∂–µ–Ω–µ—Ä.

–¢–≤–æ–π –∞–Ω–∞–ª–∏–∑:
"""

    print("\nü§î –ú–ò–†–ê–ô –¥—É–º–∞–µ—Ç...\n")

    # –ú–ò–†–ê–ô –æ—Ç–≤–µ—á–∞–µ—Ç
    response = agent.think(prompt, max_iterations=3)

    print("\n" + "=" * 80)
    print("üí¨ –û–¢–í–ï–¢ –ú–ò–†–ê–ô:")
    print("=" * 80)
    print(response)
    print("\n" + "=" * 80)


if __name__ == "__main__":
    main()
